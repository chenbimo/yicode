# æ–‡æ¡£é€‰æ‹©å™¨

æ‰©å±•ç¨‹åºå¯ä»¥æ ¹æ®è¯­è¨€ã€æ–‡ä»¶ç±»å‹å’Œä½ç½®çš„æ–‡æ¡£é€‰æ‹©å™¨æ¥è¿‡æ»¤å…¶åŠŸèƒ½ã€‚ æœ¬ä¸»é¢˜è®¨è®ºæ–‡æ¡£é€‰æ‹©å™¨ã€æ–‡æ¡£æ–¹æ¡ˆä»¥åŠä½œè€…åº”è¯¥æ³¨æ„çš„æ‰©å±•ã€‚

## æ–‡æœ¬æ–‡æ¡£ä¸åœ¨ç£ç›˜ä¸Š

å¹¶éæ‰€æœ‰æ–‡æœ¬æ–‡æ¡£éƒ½å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œä¾‹å¦‚æ–°åˆ›å»ºçš„æ–‡æ¡£ã€‚ é™¤éæŒ‡å®šï¼Œå¦åˆ™æ–‡æ¡£é€‰æ‹©å™¨é€‚ç”¨äº**æ‰€æœ‰**æ–‡æ¡£ç±»å‹ã€‚ ä½¿ç”¨ [DocumentFilter](https://code.visualstudio.com/api/references/vscode-api#DocumentFilter) `scheme` å±æ€§æ¥ç¼©å°æŸäº›æ–¹æ¡ˆçš„èŒƒå›´ï¼Œä¾‹å¦‚ `{ schema: 'file', language: ' typescript' }` ç”¨äºå­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„ TypeScript æ–‡ä»¶ã€‚

## æ–‡æ¡£é€‰æ‹©å™¨

Visual Studio Code æ‰©å±• API é€šè¿‡ [DocumentSelector](https://code.visualstudio.com/api/references/vscode-api#DocumentSelector) ç±»å‹å°†ç‰¹å®šäºè¯­è¨€çš„åŠŸèƒ½ï¼ˆä¾‹å¦‚ IntelliSenseï¼‰ä¸æ–‡æ¡£é€‰æ‹©å™¨ç›¸ç»“åˆã€‚ å®ƒä»¬æ˜¯ä¸€ç§å°†åŠŸèƒ½èŒƒå›´ç¼©å°åˆ°ç‰¹å®šè¯­è¨€çš„ç®€å•æœºåˆ¶ã€‚

ä¸‹é¢çš„ä»£ç ç‰‡æ®µä¸º TypeScript æ–‡ä»¶æ³¨å†Œäº†ä¸€ä¸ª [HoverProvider](https://code.visualstudio.com/api/references/vscode-api#HoverProvider)ï¼Œæ–‡æ¡£é€‰æ‹©å™¨æ˜¯ `typescript` è¯­è¨€æ ‡è¯†ç¬¦å­—ç¬¦ä¸²ã€‚

```ts
vscode.languages.registerHoverProvider('typescript', {
    provideHover(doc: vscode.TextDocument) {
        return new vscode.Hover('For *all* TypeScript documents.');
    }
});
```

æ–‡æ¡£é€‰æ‹©å™¨ä¸ä»…ä»…æ˜¯è¯­è¨€æ ‡è¯†ç¬¦ï¼Œæ›´å¤æ‚çš„é€‰æ‹©å™¨å¯ä»¥ä½¿ç”¨ [DocumentFilter](https://code.visualstudio.com/api/references/vscode-api#DocumentFilter) æ ¹æ® `scheme` è¿›è¡Œè¿‡æ»¤ ä»¥åŠé€šè¿‡"pattern"è·¯å¾„ glob-pattern çš„æ–‡ä»¶ä½ç½®ï¼š

```ts
vscode.languages.registerHoverProvider(
    { pattern: '**/test/**' },
    {
        provideHover(doc: vscode.TextDocument) {
            return new vscode.Hover('For documents inside `test`-folders only');
        }
    }
);
```

ä¸‹ä¸€ä¸ªç‰‡æ®µä½¿ç”¨"scheme"è¿‡æ»¤å™¨å¹¶å°†å…¶ä¸è¯­è¨€æ ‡è¯†ç¬¦ç»„åˆã€‚ "æ— æ ‡é¢˜"æ–¹æ¡ˆé€‚ç”¨äºå°šæœªä¿å­˜åˆ°ç£ç›˜çš„æ–°æ–‡ä»¶ã€‚

```ts
vscode.languages.registerHoverProvider(
    { scheme: 'untitled', language: 'typescript' },
    {
        provideHover(doc: vscode.TextDocument) {
            return new vscode.Hover('For new, unsaved TypeScript documents only');
        }
    }
);
```

## æ–‡æ¡£æ–¹æ¡ˆ

æ–‡æ¡£çš„"æ–¹æ¡ˆ"ç»å¸¸è¢«å¿½è§†ï¼Œä½†å´æ˜¯ä¸€æ¡é‡è¦çš„ä¿¡æ¯ã€‚ å¤§å¤šæ•°æ–‡æ¡£éƒ½ä¿å­˜åœ¨ç£ç›˜ä¸Šï¼Œæ‰©å±•ä½œè€…é€šå¸¸å‡è®¾ä»–ä»¬æ­£åœ¨ä½¿ç”¨ç£ç›˜ä¸Šçš„æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œä½¿ç”¨ç®€å•çš„"typescript"é€‰æ‹©å™¨ï¼Œå‡è®¾æ˜¯ **ç£ç›˜ä¸Šçš„ TypeScript æ–‡ä»¶**ã€‚ ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™ç§å‡è®¾è¿‡äºå®½æ¾ï¼Œåº”è¯¥ä½¿ç”¨æ›´æ˜ç¡®çš„é€‰æ‹©å™¨ï¼Œä¾‹å¦‚"{scheme: 'file', language: 'typescript' }"ã€‚

å½“åŠŸèƒ½ä¾èµ–äºä»ç£ç›˜è¯»å–æ–‡ä»¶/å‘ç£ç›˜å†™å…¥æ–‡ä»¶æ—¶ï¼Œè¿™ä¸€ç‚¹çš„é‡è¦æ€§å°±ä½“ç°å‡ºæ¥äº†ã€‚ æŸ¥çœ‹ä¸‹é¢çš„ç‰‡æ®µï¼š

```ts
// ğŸ‘ too lax
vscode.languages.registerHoverProvider('typescript', {
    provideHover(doc: vscode.TextDocument) {
        const { size } = fs.statSync(doc.uri.fsPath); // âš ï¸ what about 'untitled:/Untitled1.ts' or others?
        return new vscode.Hover(`Size in bytes is ${size}`);
    }
});
```

ä¸Šé¢çš„æ‚¬åœæä¾›ç¨‹åºæƒ³è¦æ˜¾ç¤ºç£ç›˜ä¸Šæ–‡æ¡£çš„å¤§å°ï¼Œä½†å®ƒæ— æ³•æ£€æŸ¥æ–‡æ¡£æ˜¯å¦å®é™…å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚ ä¾‹å¦‚ï¼Œå®ƒå¯èƒ½æ˜¯æ–°åˆ›å»ºçš„ä½†å°šæœªä¿å­˜ã€‚ æ­£ç¡®çš„æ–¹æ³•æ˜¯å‘Šè¯‰ VS Code è¯¥æä¾›ç¨‹åºåªèƒ½å¤„ç†ç£ç›˜ä¸Šçš„æ–‡ä»¶ã€‚

```ts
// ğŸ‘ only works with files on disk
vscode.languages.registerHoverProvider(
    { scheme: 'file', language: 'typescript' },
    {
        provideHover(doc: vscode.TextDocument) {
            const { size } = fs.statSync(doc.uri.fsPath);
            return new vscode.Hover(`Size in bytes is ${size}`);
        }
    }
);
```

ï¼ƒï¼ƒ æ¦‚æ‹¬

æ–‡æ¡£é€šå¸¸å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸Šï¼Œä½†å¹¶éæ€»æ˜¯å¦‚æ­¤ï¼šæœ‰æ— æ ‡é¢˜æ–‡æ¡£ã€Git ä½¿ç”¨çš„ç¼“å­˜æ–‡æ¡£ã€æ¥è‡ªè¿œç¨‹æºï¼ˆå¦‚ FTPï¼‰çš„æ–‡æ¡£ç­‰ç­‰ã€‚ å¦‚æœæ‚¨çš„åŠŸèƒ½ä¾èµ–äºç£ç›˜è®¿é—®ï¼Œè¯·ç¡®ä¿ä½¿ç”¨å¸¦æœ‰"æ–‡ä»¶"æ–¹æ¡ˆçš„æ–‡æ¡£é€‰æ‹©å™¨ã€‚

ï¼ƒï¼ƒ ä¸‹ä¸€æ­¥

è¦äº†è§£æœ‰å…³ VS Code æ‰©å±•æ€§æ¨¡å‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å°è¯•ä»¥ä¸‹ä¸»é¢˜ï¼š

-   [æ‰©å±•æ¸…å•æ–‡ä»¶](https://code.visualstudio.com/api/references/extension-manifest) - VS Code package.json æ‰©å±•æ¸…å•æ–‡ä»¶å‚è€ƒ
-   [è´¡çŒ®ç‚¹](https://code.visualstudio.com/api/references/contribution-points) - VS Code è´¡çŒ®ç‚¹å‚è€ƒ
